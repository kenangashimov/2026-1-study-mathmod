---
## Author
author:
  name: Кенан Гашимов
  email: 1032235820@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Математическое моделирование"
subtitle: "Лабораторная работа № 2"
license: "CC BY"
---

# Цель работы

Рассмотрим пример построения математической модели, помогающей выбрать оптимальную стратегию поиска и преследования.  
Пусть в условиях тумана катер береговой охраны преследует лодку браконьеров. В некоторый момент туман рассеивается, и лодка обнаруживается на расстоянии $k$ км от катера. После этого лодка снова скрывается в тумане и продолжает движение прямолинейно в неизвестном направлении. Известно, что скорость катера в $n$ раз больше скорости лодки.  
Требуется определить, по какой траектории должен двигаться катер, чтобы гарантированно догнать лодку.

# Задание

1. Выполнить рассуждения и вывести дифференциальные уравнения при условии, что скорость катера больше скорости лодки в $n$ раз.
2. Построить траектории движения катера и лодки для двух вариантов начальных условий.
3. По графику определить точку пересечения траекторий катера и лодки.

# Выполнение лабораторной работы

Положим $t_0=0$. В момент обнаружения лодки выберем начало координат в точке её положения: $X_0=0$. Катер в этот момент находится на расстоянии $k$ от лодки, то есть относительно выбранного начала координат его положение равно $X_0=k$ (с учётом направления — два возможных случая будут рассмотрены ниже).

Перейдём к полярным координатам. Считаем, что полюс — это точка обнаружения лодки: $x_0=0$ (то есть $\theta=x_0=0$), а полярная ось $r$ направлена через положение катера береговой охраны.

## Поиск расстояния перехода $x$

Найдём расстояние $x$, после достижения которого катер должен начать движение вокруг полюса. Рассмотрим момент времени $t$, когда катер и лодка оказываются на одинаковом расстоянии $x$ от полюса.

За это время лодка проходит путь $x$, а катер — $x-k$ или $x+k$ (в зависимости от того, расположен ли катер «по ту же сторону» относительно выбранной оси или «с противоположной»).

Скорость лодки обозначим $v$, тогда скорость катера равна $nv$. Время движения одинаково, поэтому:

- в первом случае:
  $$
  \frac{x}{v}=\frac{x+k}{nv},
  $$
- во втором случае:
  $$
  \frac{x}{v}=\frac{x-k}{nv}.
  $$

Отсюда получаем два значения $x_1$ и $x_2$, и далее решаем задачу для обоих начальных вариантов:

$$
x_1=\frac{k}{n+1}, \quad \theta=0,
$$

$$
x_2=\frac{k}{n-1}, \quad \theta=-\pi.
$$

## Разложение скорости катера на компоненты

После того как катер окажется на том же расстоянии от полюса, что и лодка, прямолинейное движение становится неэффективным: чтобы перехватить лодку при неизвестном направлении её ухода, катер должен перейти к движению вокруг полюса, одновременно удаляясь от него.

Разложим скорость катера на:

- радиальную составляющую $v_r$, направленную вдоль $r$:
  $$
  v_r=\frac{dr}{dt},
  $$
- тангенциальную составляющую $v_t$, отвечающую за вращение:
  $$
  v_t=r\frac{d\theta}{dt}.
  $$

Чтобы сохранять равенство радиусов лодки и катера после момента перехода, требуется, чтобы катер удалялся от полюса с той же скоростью, что и лодка:

$$
\frac{dr}{dt}=v.
$$

При этом модуль полной скорости катера равен $nv$, значит по теореме Пифагора для прямоугольного треугольника компонент:

$$
(nv)^2=v_r^2+v_t^2.
$$

Так как $v_r=v$, получаем:

$$
v_t=\sqrt{(nv)^2-v^2}=v\sqrt{n^2-1}.
$$

Следовательно,

$$
r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
$$

## Система дифференциальных уравнений

Задача сводится к решению системы:

$$
 \begin{cases}
   \frac{dr}{dt}=v,\\
   r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
 \end{cases}
$$

Начальные условия для двух вариантов:

$$
 \begin{cases}
   \theta_0=0,\\
   r_0=\frac{k}{n+1},
 \end{cases}
$$

$$
 \begin{cases}
   \theta_0=-\pi,\\
   r_0=\frac{k}{n-1}.
 \end{cases}
$$

Исключая $t$ из системы, получаем уравнение траектории в полярных координатах:

$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}.
$$

Решение этого уравнения при соответствующих начальных условиях задаёт искомую траекторию катера (в виде расходящейся спирали).

# Условие задачи

На море в тумане катер береговой охраны преследует лодку браконьеров.  
Через некоторый промежуток времени туман рассеивается, и лодка обнаруживается на расстоянии $20$ км от катера.  
Затем лодка снова скрывается в тумане и уходит прямолинейно в неизвестном направлении.  
Скорость катера в $5$ раз больше скорости лодки браконьеров.

Для моделирования процесса и построения графиков использовались внешние файлы с программным кодом:

{{< include ../project/markdown/01_task_of_chase/01_task_of_chase.qmd >}}

{{< include ../project/markdown/02_task_of_chase/02_task_of_chase.qmd >}}

# Анализ результатов моделирования

В работе выполнено численное исследование движения катера, описываемого уравнением

$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}},
$$

а также проведено сопоставление полученной траектории катера с траекторией лодки, заданной аналитически и представленной в полярной системе координат.

## Базовые эксперименты

### 1. Случай (case = plus)

![Базовый эксперимент (case=plus)](image/single_experiment.png)

На полярном графике траектория катера имеет вид расходящейся спирали: радиус $r$ монотонно растёт с увеличением угла $\theta$. Поскольку $dr/d\theta$ пропорциональна $r$, рост радиуса по углу носит экспоненциальный характер.

Траектория лодки соответствует прямой в декартовой системе координат и в полярном представлении проявляется как луч (направление фиксировано, а расстояние от полюса растёт линейно по параметру движения).

На графике видно, что катер при выбранной стратегии постепенно «накрывает» область возможных направлений движения лодки.

### 2. Случай (case = minus)

![Базовый эксперимент (case=minus)](image/single_experiment_minus.png)

Во втором эксперименте стартовый радиус больше, поэтому катер начинает движение дальше от полюса. Характер кривой остаётся тем же (расходящаяся спираль), однако траектория смещена наружу и масштабирована по радиусу.

Различие режимов case=plus и case=minus определяется исключительно начальными условиями: форма траектории сохраняется, меняется лишь её стартовый масштаб.

## Параметрическое сканирование по $n$

![Сканирование траекторий катера](image/parametric_scan_cutter_comparison.png)

Исследовано влияние параметра $n$ на динамику системы для обоих вариантов начальных условий.

Из уравнения следует, что «темп» изменения радиуса по углу определяется коэффициентом

$$
\frac{1}{\sqrt{n^2-1}}.
$$

При увеличении $n$ этот коэффициент уменьшается, поэтому:

- при малых $n$ спираль расходится быстрее;
- при больших $n$ радиус растёт заметно медленнее;
- траектории становятся более «пологими» по углу.

На рисунке видно, что для $n=3$ рост наиболее стремительный, а для $n=10$ — наиболее плавный.

## Анализ метрики scale_ratio

![Зависимость scale_ratio от n](image/scale_ratio_vs_n.png)

Введена метрика относительного масштаба:

$$
\text{scale\_ratio}=\frac{r_{\text{final}}}{\max(r_{\text{boat}})}.
$$

Она показывает, насколько «крупнее» по радиусу становится траектория катера по сравнению с максимальным радиусом лодки на рассматриваемом интервале.

По графику:

- при малых $n$ метрика существенно больше $1$, катер быстро опережает лодку по радиальному росту;
- при увеличении $n$ значение метрики снижается;
- при больших $n$ масштабы траекторий становятся ближе друг к другу.

Для режима case=minus метрика выше, что согласуется с большим стартовым радиусом.

## Время вычислений

![Зависимость времени вычисления от n](image/computation_time_vs_n.png)

Проведён бенчмаркинг численного решения ОДУ при различных $n$.

Наблюдения:

- время расчёта порядка $\sim 6\times 10^{-4}$ секунды;
- заметной зависимости времени от $n$ нет;
- небольшие флуктуации объясняются адаптивным шагом интегрирования и особенностями численной реализации.

# Выводы

1. Траектория катера в полярной системе координат описывается экспоненциально расходящейся спиралью.
2. Параметр $n$ определяет скорость радиального «раскрытия» спирали: чем больше $n$, тем медленнее растёт радиус по углу $\theta$.
3. Вариант начального условия (case) задаёт масштаб и стартовую позицию траектории, но не меняет её качественную форму.
4. Численное решение устойчиво, а вычислительные затраты практически не зависят от параметров модели.

Полученные результаты согласуются с аналитической структурой уравнения

$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}.
$$

# Список литературы {.unnumbered}

1. [Задача о погоне](https://esystem.rudn.ru/pluginfile.php/2290141/mod_resource/content/2/Лабораторная%20работа%20№%201.pdf)
